# DESCRIPTION: Github actions config
name: Verilator build & run test

on:
  push:
  pull_request:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 0' # weekly

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v3

# This uses the ":stable" version of Verilator, you may prefer ":latest"
# We run make from inside the container, overriding default entry point (Verilator binary itself)
# You may prefer to build install Verilator from git locally (slower but avoids docker)
      - name: Verilate
        run: docker run -v ${PWD}:/work --user $(id -u):$(id -g) -e CCACHE_DIR=/work/.ccache --cmd cd verilator_sim && make verilator/verilator:stable
